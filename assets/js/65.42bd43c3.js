(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{813:function(s,t,a){"use strict";a.r(t);var e=a(17),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("前言")])])]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("Public Key")]),s._v(" 认证的主要魅力在于认证时承诺不必提供密码就能够同远程系统建立连接。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Public Key")]),s._v(" 认证的基础在于一对密钥，"),a("code",[s._v("public key")]),s._v(" 和 "),a("code",[s._v("private key")]),s._v("，"),a("code",[s._v("public key")]),s._v(" 对数据进行加密而且只能用于加密，"),a("code",[s._v("private key")]),s._v(" 只能对所匹配的 "),a("code",[s._v("public key")]),s._v(" 加密过的数据进行解密。")])])]),s._v(" "),a("h2",{attrs:{id:"实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("实现")])])]),s._v(" "),a("h3",{attrs:{id:"目标服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标服务器"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("目标服务器")])])]),s._v(" "),a("p",[s._v("目标服务器启动 "),a("code",[s._v("ssh")]),s._v(" 服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 ssh 状态")]),s._v("\nsystemctl status sshd\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 ssh")]),s._v("\nsystemctl start sshd\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止 ssh")]),s._v("\nsystemctl stop sshd\n")])])]),a("h3",{attrs:{id:"本地客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地客户端"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("本地客户端")])])]),s._v(" "),a("h4",{attrs:{id:"生成秘钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成秘钥"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("生成秘钥")])])]),s._v(" "),a("p",[s._v("本地生成 "),a("code",[s._v("id_rsa")]),s._v("（私钥）和 "),a("code",[s._v("id_rsa.pub")]),s._v(" （公钥）保存在 "),a("code",[s._v("~/.ssh")]),s._v(" 目录下。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ssh-keygen\n")])])]),a("blockquote",[a("p",[s._v("密钥对生成过程会提示输入私钥加密密码，可以直接回车不使用密码保护。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-keygen")]),s._v("\nGenerating public/private rsa key pair.\nEnter "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" to save the key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/root/.ssh/id_rsa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":    \nEnter passphrase "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empty "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" no passphrase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": \nEnter same passphrase again: \nYour identification has been saved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.ssh/id_rsa.\nYour public key has been saved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:/gGrlDJN5euMS5aai5feBkEI/0WjEnzPzx1xGtdkKG4 root@localhost.localdomain\nThe key's randomart image is:\n+---"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("RSA "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("----+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(".o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("  o      +o  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" .o.oo "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("  + +"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  oo.o. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" B     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("oo  E      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".oSo "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    .o +o+.      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ooB + "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   .oX."),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  .o"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("o"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".o "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SHA256"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-----+\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls ~/.ssh/")]),s._v("\nid_rsa  id_rsa.pub  known_hosts\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])])])]),s._v(" "),a("h4",{attrs:{id:"上传秘钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上传秘钥"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("上传秘钥")])])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ssh-copy-id -i .ssh/id_rsa.pub "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-p port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" user@host_address\n")])])]),a("p",[s._v("上述指令中：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v(".ssh/id_rsa.pub")]),s._v(" 刚刚生成的公钥")]),s._v(" "),a("li",[a("code",[s._v("port")]),s._v(" 目标服务器 "),a("code",[s._v("ssh")]),s._v(" 服务端口 一般为 22")]),s._v(" "),a("li",[a("code",[s._v("user")]),s._v(" 目标服务器登录账号")]),s._v(" "),a("li",[a("code",[s._v("host_address")]),s._v(" 目标服务器地址")])]),s._v(" "),a("blockquote",[a("p",[s._v("上传成功后，目标服务器 "),a("code",[s._v("/home/user/.ssh")]),s._v(" 会生成 "),a("code",[s._v("authorized_keys")]),s._v(" 文件，目标服务器接到登录请求，会从 "),a("code",[s._v("authorized_keys")]),s._v(" 中查找，是否有相同的用户名、ip，如果有目标服务器会随机生成一个字符串然后使用使用公钥进行加密，再发送给客户端。客户端接到目标服务器发来的信息后，会使用私钥进行解密，然后将解密后的字符串发送给目标服务器；目标服务器接到回传信息后，会给先前生成的字符串进行比对，如果一致，则允许免密登录。 "),a("code",[s._v("authorized_keys")]),s._v(" 中可以添加多个公钥，每个公钥占据一行。")])]),s._v(" "),a("h3",{attrs:{id:"修改权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改权限"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("修改权限")])])]),s._v(" "),a("p",[s._v("在目标服务器上务必要设置权限，根据 "),a("code",[s._v("Linux")]),s._v(" 的安全要求，如果权限不对，自动登录将不会生效。")]),s._v(" "),a("h2",{attrs:{id:"免密登录验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#免密登录验证"}},[s._v("#")]),s._v(" "),a("em",[a("strong",[s._v("免密登录验证")])])]),s._v(" "),a("p",[s._v("客户端上，尝试免密登录远程服务器")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" host_address\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);