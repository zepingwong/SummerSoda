(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{684:function(t,s,a){"use strict";a.r(s);var e=a(2),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"问题描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("问题描述")])])]),t._v(" "),s("p",[t._v("C盘（系统盘）爆红了，检查了一下 "),s("code",[t._v("C:\\Users\\我的用户名")]),t._v(" 快100G了，除了正常的 "),s("code",[t._v("下载（Downloads）")]),t._v(" 、 "),s("code",[t._v("文档（Documents）")]),t._v(" 、 "),s("code",[t._v("图片（Pictures）")]),t._v(" 等等几个目录外，还有一个隐藏目录 "),s("code",[t._v("AppData")]),t._v(" ，将近70G的一个目录。"),s("code",[t._v("C:\\Users\\用户名\\AppData")]),t._v(" 里面一般有三个文件夹，分别是 "),s("code",[t._v("Local")]),t._v(" ， "),s("code",[t._v("LocalLow")]),t._v("， "),s("code",[t._v("Roaming")]),t._v(" ，简单地来说，都是用来存放软件的配置文件和临时文件的，里面有很多以软件名称或软件公司命名的文件夹，还有用户账户的配置文件。随着系统使用时间的增加和安装软件的增多， "),s("code",[t._v("AppData")]),t._v(" 占用的空间会越来越大。")]),t._v(" "),s("p",[s("strong",[t._v("思考：")]),t._v(" 如何才能把C:\\Users整个目录放到其他盘。")]),t._v(" "),s("h2",{attrs:{id:"解决过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决过程"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("解决过程")])])]),t._v(" "),s("h3",{attrs:{id:"c-users-目录下有什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#c-users-目录下有什么"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[s("code",[t._v("C:\\Users\\")]),t._v("目录下有什么")])])]),t._v(" "),s("ul",[s("li",[t._v("每个用户的 "),s("code",[t._v("文档")]),t._v(" 、 "),s("code",[t._v("桌面")]),t._v(" 、 "),s("code",[t._v("下载")]),t._v(" 、 "),s("code",[t._v("图片")]),t._v(" 、 "),s("code",[t._v("视频")]),t._v(" 等文件夹（此类文件夹可以改变位置）")]),t._v(" "),s("li",[s("code",[t._v("AppData")]),t._v(" 目录默认在用户根目录下，存储了大部分软件的数据、配置（无法移动位置）")]),t._v(" "),s("li",[s("code",[t._v(".config")]),t._v(" 、 "),s("code",[t._v(".ssh")]),t._v(" 、 "),s("code",[t._v(".config")]),t._v(" 、 "),s("code",[t._v("scoop")]),t._v("  等配置（无法移动位置）")]),t._v(" "),s("li",[t._v("许多软件的默认数据位置（部分软件可以修改）")])]),t._v(" "),s("h3",{attrs:{id:"移动目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#移动目录"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("移动目录")])])]),t._v(" "),s("p",[s("code",[t._v("文档")]),t._v(" 、 "),s("code",[t._v("桌面")]),t._v(" 、 "),s("code",[t._v("下载")]),t._v(" 、 "),s("code",[t._v("图片")]),t._v(" 、 "),s("code",[t._v("视频")]),t._v(" 等文件夹查看文件夹位置属性，即可根据需要移动默认位置，但是此办法无法解决"),s("code",[t._v("AppData")]),t._v("和其他配置目录的问题。这类方法显然不是我想要的，我的终极目标是将，整个"),s("code",[t._v("C\\Users")]),t._v("目录移动到其他盘。下面分新安装系统和已安装系统两种情况介绍解决办法：")]),t._v(" "),s("h4",{attrs:{id:"一、-安装-win10-11系统时修改默认用户路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、-安装-win10-11系统时修改默认用户路径"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("一、 安装 win10/11系统时修改默认用户路径")])])]),t._v(" "),s("h5",{attrs:{id:"_1、-安装win10-11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、-安装win10-11"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("1、 安装Win10/11")])])]),t._v(" "),s("blockquote",[s("p",[t._v("当 windows 连接到网络的时候有时 Sysprep 会失败，所以建议全程关闭网络连接安装系统")])]),t._v(" "),s("p",[t._v("安装系统的方法不多做介绍。安装系统重启后"),s("strong",[t._v("停留在选择地区的配置界面")]),t._v("。")]),t._v(" "),s("h5",{attrs:{id:"_2、-进入-audit-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、-进入-audit-mode"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("2、 进入 "),s("code",[t._v("Audit Mode")])])])]),t._v(" "),s("p",[t._v("在系统配置选择地区的界面，按下 "),s("code",[t._v("Ctrl+Shift+F3")]),t._v(" ，这时 windows 会重启，进入 "),s("code",[t._v("Audit Mode")]),t._v(" ，然后显示一个 "),s("code",[t._v("System Preparation Tool")]),t._v(" ，点击取消，将它关闭。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/9f2055a1d34e460cb007b7feb535202d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rGf5Z-O5pKF5Zi055qE5bed576M,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center",alt:"关闭System Preparation Tool"}})]),t._v(" "),s("h5",{attrs:{id:"_3、-新建relocate-xml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、-新建relocate-xml"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("3、 新建relocate.xml")])])]),t._v(" "),s("blockquote",[s("p",[t._v("现在你可以将电脑连接到网络了。")])]),t._v(" "),s("p",[t._v("接下来我们要使用 "),s("code",[t._v("System Preparation Tool (Sysprep)")]),t._v(" 工具来设置用户路径。这个工具会执行一个 xml 文件中的配置（也就是 "),s("code",[t._v("relocate.xml")]),t._v("）\n我们现在只需要一个非常简单的 xml配置文件，只需包含以下内容：")]),t._v(" "),s("ul",[s("li",[t._v("windows 的版本（32 或 64 bit）")]),t._v(" "),s("li",[t._v("用户文件夹的新路径（例如 "),s("code",[t._v("D:/Users")]),t._v(" ）")])]),t._v(" "),s("p",[t._v("新建 "),s("code",[t._v("relocate.xml")]),t._v(" ，并使用记事本打开")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("警告，在操作之前，请先读一下这个：")]),t._v("\n1、Windows 以字母来标识盘符，但是当安装了 windows 重启之后，本来你想把用户目录安装到 d 盘，但这个盘符可能会发生改变，比如变成了 e 盘，这个时候就会失败，所以一定要确定好盘符。\n2、xml 文件保存到磁盘根目录（不能是 C 盘），例如我把它保存到了：D:\\relocate.xml\n3、部分计算机在Audit Mode下因为缺少驱动，键盘无法使用，可以借助其他计算机编写，并拷贝，也可以完全用鼠标操作完成，看个人能力。")])]),t._v(" "),s("p",[t._v("将以下代码粘贴到配置文件中")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="utf-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("unattend")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("urn:schemas-microsoft-com:unattend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("settings")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("pass")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("oobeSystem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("component")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Microsoft-Windows-Shell-Setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("processorArchitecture")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("amd64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("publicKeyToken")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("31bf3856ad364e35"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("language")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("neutral"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("versionScope")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("nonSxS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("wcm")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://schemas.microsoft.com/WMIConfig/2002/State"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("FolderLocations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ProfilesDirectory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("D:\\Users"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ProfilesDirectory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("FolderLocations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("git\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("settings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("unattend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("blockquote",[s("p",[s("strong",[t._v("记得修改 "),s("code",[t._v("User")]),t._v(" 目录位置")])])]),t._v(" "),s("h5",{attrs:{id:"_4、运行-sysprep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、运行-sysprep"}},[t._v("#")]),t._v(" ***4、运行 "),s("code",[t._v("Sysprep")]),t._v(" ***")]),t._v(" "),s("p",[t._v("以管理员身份运行cmd，首先，关闭 "),s("code",[t._v("WMP Network Sharing Service")]),t._v(" 服务：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("net stop wmpnetworksvc\n")])])]),s("p",[t._v("然后运行 "),s("code",[t._v("Sysprep")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("%windir%"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("system32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sysprep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sysprep.exe /oobe /reboot /unattend:d:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("relocate.xml\n")])])]),s("p",[t._v("上述命令告诉系统从 "),s("code",[t._v("Windows\\System32\\Sysprep")]),t._v(" 运行 "),s("code",[t._v("Sysprep")]),t._v("，执行 "),s("code",[t._v("D:/relocate.xml")]),t._v(" 中的指令，为 "),s("code",[t._v("OOBE（the firlst boot of newly installed Windows）")]),t._v("重启准备系统，最后重启。")]),t._v(" "),s("h5",{attrs:{id:"_5、完成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、完成"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("5、完成")])])]),t._v(" "),s("p",[t._v("完成上述操作后，自动重启进入系统，检查"),s("code",[t._v("User")]),t._v("目录已经移动到了D盘")]),t._v(" "),s("h4",{attrs:{id:"二、-在已经安装好的-windows-系统上迁移用户目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、-在已经安装好的-windows-系统上迁移用户目录"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("二、 在已经安装好的 Windows 系统上迁移用户目录")])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("警告：操作之前，一定要先创建一个系统映像，做好备份。")]),t._v("\n对一个 OEM 预先安装的 Windows 使用 Sysprep 是非常危险的。电脑厂商可能有他们自己的 unattended answer file，这样可能就会忽略掉你的 unattended file。在这个过程中可能会出各种错误，所以不建议操作。\n如果中途出错了，你的备份文件可以帮助你恢复。\n这个操作非常有可能导致你的电脑恢复出厂设置。")])]),t._v(" "),s("p",[s("strong",[t._v("警告****1703 或者更高版本，请不要禁用已存在的用户！！！")]),t._v("\n在 Win10 1703 或更高版本上，千万不要禁用现有用户，因为禁用现有用户可能会让你无法登录 Windows，进而需要重装。")]),t._v(" "),s("h5",{attrs:{id:"_1、-新建relocate-xml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、-新建relocate-xml"}},[t._v("#")]),t._v(" "),s("strong",[s("em",[t._v("1、 新建")]),s("code",[t._v("relocate.xml")])])]),t._v(" "),s("p",[t._v("按照上面说过的步骤新建一个 "),s("code",[t._v("relocate.xml")]),t._v(" 文件")]),t._v(" "),s("h5",{attrs:{id:"_2、-运行-sysprep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、-运行-sysprep"}},[t._v("#")]),t._v(" ***2、 运行 "),s("code",[t._v("Sysprep")]),t._v(" ***")]),t._v(" "),s("p",[t._v("按照上面说过的步骤运行 "),s("code",[t._v("Sysprep")])]),t._v(" "),s("h5",{attrs:{id:"_3、-oobe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、-oobe"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("3、 OOBE")])])]),t._v(" "),s("p",[t._v("虽然你已经安装了 Win10/11，但是在 "),s("code",[t._v("Sysprep")]),t._v(" 运行之后 "),s("code",[t._v("OOBE")]),t._v(" 仍然会运行，这意味着你的电脑会经历初始化程序。")]),t._v(" "),s("p",[t._v("这里有两点需要注意：")]),t._v(" "),s("ul",[s("li",[t._v("Windows 要求你输入产品密钥，但是不需要去输入，单击跳过就行了;")]),t._v(" "),s("li",[t._v("之前的账户还会存在，但是 "),s("code",[t._v("OOBE")]),t._v(" 会要求新建一个用户，如果新建的这个用户和已存在的用户名字相同，那就会发生错误。只需要新建一个随意的账户，之后，再将它删掉就可以了。")])]),t._v(" "),s("h2",{attrs:{id:"学习过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#学习过程"}},[t._v("#")]),t._v(" "),s("em",[s("strong",[t._v("学习过程")])])]),t._v(" "),s("p",[t._v("1、关于Audit Mode和OOBE，请看官方的说明：")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/boot-windows-to-audit-mode-or-oobe?view=windows-11",target:"_blank",rel:"noopener noreferrer"}},[t._v("将 Windows 启动至审核模式或 OOBE"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("2、参考文章："),s("a",{attrs:{href:"https://www.tenforums.com/tutorials/1964-move-users-folder-location-windows-10-a.html?utm_source=ld246.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to Move Users Folder to another Location in Windows 10"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);